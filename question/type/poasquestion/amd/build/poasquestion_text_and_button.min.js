define(["jquery","jqueryui","qtype_poasquestion/interface","qtype_poasquestion/jquery.elastic.1.6.11","qtype_poasquestion/jquery.mousewheel","qtype_poasquestion/jquery.scrollstop","qtype_poasquestion/jquery.textarea-highlighter","qtype_poasquestion/jquery.panzoom","qtype_poasquestion/jquery-textrange","qtype_poasquestion/panzoomtools"],function(a){var b={current_input:null,data:null,dialog:null,dialogwidth:1e3,dialogtitle:null,onfirstpresscallback:null,oneachpresscallback:null,onclosecallback:null,oncancelclicked:null,onsaveclicked:null,extendeddata:null,init:function(a,c){b.dialogwidth=a,b.dialogtitle=c},fix_textarea_rows:function(b){var c=a(b.target);c.attr("rows",c.val().split("\n").length)},set_handler:function(c,d,e,f,g){if(null!=d&&null!=c){d.length>0&&0!=d.indexOf("#")&&(d="#"+d),c.length>0&&0!=c.indexOf("#")&&(c="#"+c);var h=a(c);h.after('<a href="#" name="button_'+c.substr(1)+'" id="'+d.substr(1)+'" title="'+e+'" style="margin-left: 5px" ><img src="'+f+'" /></a>');var i=a(d),j={pagewidth:g,targetinput:h};a(i).click(j,b.btn_pressed),a(h).elastic()}},btn_pressed:function(a){a.preventDefault();var c=null===b.dialog;b.current_input=a.data.targetinput,b.data=b.get_input_data(),c&&b.setup_dialog(),c&&"function"==typeof b.onfirstpresscallback&&b.onfirstpresscallback(),c||"function"!=typeof b.oneachpresscallback||b.oneachpresscallback(),b.dialog.dialog("open")},setup_dialog:function(c){b.dialog=a('<div id="poasquestion_textandbutton_dialog"><p>Loading...</p></div>'),b.is_stand_alone()?buttons=[{text:M.str.editor.close,click:b.oncancelclicked}]:buttons=[{text:M.str.moodle.savechanges,click:b.onsaveclicked},{text:M.str.moodle.cancel,click:b.oncancelclicked}],b.dialog.dialog({modal:!0,closeOnEscape:!0,width:b.dialogwidth,minWidth:"1000px",title:b.dialogtitle,close:function(){"function"==typeof b.onclosecallback&&b.onclosecallback()},buttons:buttons})},setup:function(a){b.onfirstpresscallback=a.onfirstpresscallback,b.oneachpresscallback=a.oneachpresscallback,b.onclosecallback=a.onclosecallback,b.oncancelclicked=a.oncancelclicked,b.onsaveclicked=a.onsaveclicked,b.extendeddata=a.extendeddata},close_and_set_new_data:function(a){"string"==typeof a?(b.data=a,b.set_input_data(a)):b.set_input_data(b.data),b.dialog.dialog("close")},get_input_data:function(){return b.current_input?b.current_input.val():""},set_input_data:function(a){b.current_input&&b.current_input.val(a)},is_stand_alone:function(){return 0===b.current_input.length||"undifined"==typeof b.current_input}};return window.M.poasquestion_text_and_button=b});