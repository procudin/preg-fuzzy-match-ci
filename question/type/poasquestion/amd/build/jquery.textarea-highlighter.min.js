!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){var b;!function(a){"use strict";var b=function(){function a(){}return a.prototype.orderBy=function(a,b){return a.sort(function(a,c){return parseInt(a[b],10)-parseInt(c[b],10)})},a.prototype.removeOverlapingIndecies=function(a){for(var b,c,d=[],e=0,f=a.length;e<f;e++){b=a[e];for(var g=e+1;g<f;g++)c=a[g],this.isOverlap(b,c)&&d.push(g)}return a.slice(0).filter(function(a,b){return d.indexOf(b)===-1})},a.prototype.isOverlap=function(a,b){return a.start<b.end&&b.start<a.end},a.prototype.cleanupOnWordBoundary=function(a,b,c){c=c||!0;for(var d,e,f,g=[],h=0,i=b.length;h<i;h++)d=b[h],e=a.slice(d.start,d.end),f=a.slice(d.start-1,d.end+1),c&&this.isWrappedByASCII(e)&&!this.checkWordBoundary(e,f)&&g.push(h);return b.slice(0).filter(function(a,b){return g.indexOf(b)===-1})},a.prototype.makeTokenized=function(a,b){for(var c,d=[],e=0,f=0,g=0,h=b.length;g<h;g++)c=b[g],c.end<c.start||(f=c.start,f>e&&d.push({value:a.slice(e,f),type:"text"}),d.push({value:a.slice(f,c.end),type:c.type}),e=c.end);return e<a.length&&d.push({value:a.slice(e,a.length),type:"text"}),d},a.prototype.checkWordBoundary=function(a,b){return new RegExp("\\b"+this.escapeRegExp(a)+"\\b").test(b)},a.prototype.isWrappedByASCII=function(a){return/^\w.*\w$|^\w+$/.test(a)},a.prototype.escapeHTML=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},a.prototype.escapeRegExp=function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},a.prototype.sanitizeBreakLines=function(a){return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n")},a.prototype.getUniqueArray=function(a){return a.filter(function(a,b,c){return""!==a&&c.indexOf(a)===b})},a.prototype.createHTML=function(a){for(var b=[],c=0,d=a.length;c<d;c++)"text"===a[c].type?b.push(a[c].value):b.push(this.getTextInSpan(a[c].type,a[c].value));return b.join("")},a.prototype.getTextInSpan=function(a,b){return'<span class="'+a+'">'+b+"</span>"},a.prototype.browser=function(){var a=navigator.userAgent,b=/(msie|trident)/i.test(a),c=/chrome/i.test(a),d=/firefox/i.test(a),e=/safari/i.test(a)&&!c,f=/iphone/i.test(a);return b?{msie:!0}:c?{chrome:!0}:d?{firefox:!0}:f?{iphone:!0}:e?{safari:!0}:{msie:!1,chrome:!1,firefox:!1,safari:!1,iphone:!1}},a}();a.Helper=b}(b||(b={}));var b;!function(a,c,d,e){"use strict";var f="textareaHighlighter",g=new b.Helper,h=function(b,c){this.$element=b,this.element=this.$element[0],this.settings=a.extend({},h.DEFAULTS,this.$element.data(),c),this.$wrapDiv=a(d.createElement("div")).addClass("textarea-highlighter-wrap"),this.$backgroundDiv=a(d.createElement("div")).addClass("background-div "+this.$element.attr("class")),this.$autoSize=a('<pre><div class="autosize"></div></pre>').addClass(this.$element.attr("class")).hide(),this.$autoSizeElement=this.$autoSize.find(".autosize"),this.init()};h.DEFAULTS={matches:[],isAutoExpand:!0,typingDelay:30,debug:!1},h.prototype.init=function(){var a=this,b=this.$element,c=this.settings,d=this.$wrapDiv,e=this.$backgroundDiv;a.updateStyle(),b.wrap(d).before(e),c.isAutoExpand&&b.after(a.$autoSize),a.updateHeight(),a.bindEvents(),a.highlight()},h.prototype.bindEvents=function(){var a=this,b=this.$element;if(b.data("highlighterTimerId",-1).on("scroll.textarea.highlighter",function(){a.$backgroundDiv.scrollTop(b.scrollTop())}),"onpropertychange"in a.element){var c=(new Date).getTime(),d=0,e=Math.abs;b.on("input.textarea.highlighter keyup.textarea.highlighter",function(b){d=e(c-(new Date).getTime()),d>10&&(a.change(b),c=(new Date).getTime())}),b.on("keydown.textarea.highlighter",function(b){d=e(c-(new Date).getTime()),8===b.which&&(d<10||250<d)&&(a.change(b),c=(new Date).getTime())})}else b.on("input.textarea.highlighter",function(b){a.change(b)})},h.prototype.change=function(a){var b=this;if(/(37|38|39|40)/.test(a.keyCode))return!0;b.updateHeight(),b.$element.data("highlighterTimerId")!==-1&&(clearTimeout(b.$element.data("highlighterTimerId")),b.$element.data("highlighterTimerId",-1));var c=setTimeout(function(){b.highlight()},b.settings.typingDelay);b.$element.data("highlighterTimerId",c)},h.prototype.highlight=function(){var a=this,b=a.$element.val();a.settings;b=a.getHighlightedContent(b),a.$backgroundDiv.html(b),a.updateHeight(),a.$element.trigger("textarea.highlighter.highlight")},h.prototype.getHighlightedContent=function(a){for(var b=this,c=JSON.parse(JSON.stringify(b.settings.matches)),d=0,e=c.length;d<e;d++)c[d].end++;c=g.orderBy(c,"start"),c=g.removeOverlapingIndecies(c);for(var f=g.makeTokenized(a,c),d=0,e=f.length;d<e;d++)f[d].value=g.escapeHTML(f[d].value);return g.createHTML(f)},h.prototype.updateMatches=function(a){var b=this;b.settings.matches=a,b.highlight()},h.prototype.updateStyle=function(){var a=this,b=this.$element,c=this.settings,d={paddingTop:parseInt(b.css("padding-top"),10),paddingRight:parseInt(b.css("padding-right"),10),paddingBottom:parseInt(b.css("padding-bottom"),10),paddingLeft:parseInt(b.css("padding-left"),10)};g.browser().iphone&&(d.paddingRight+=3,d.paddingLeft+=3),this.$wrapDiv.css({position:"relative"}),this.$backgroundDiv.css({position:"absolute",height:"100%","font-family":"inherit",color:c.debug?"#f00":"transparent","padding-top":d.paddingTop,"padding-right":d.paddingRight,"padding-bottom":d.paddingBottom,"padding-left":d.paddingLeft}),a.cloneCSSToTarget(a.$backgroundDiv),c.isAutoExpand&&(a.$autoSize.css({top:0,left:0,"font-family":"inherit",position:"absolute","padding-top":d.paddingTop,"padding-right":d.paddingRight,"padding-bottom":d.paddingBottom,"padding-left":d.paddingLeft}),a.cloneCSSToTarget(a.$autoSize)),b.css({color:c.debug?"rgba(0,0,0,0.5)":"inherit",position:"relative",background:"none"})},h.prototype.updateHeight=function(){var a=this;if(a.settings.isAutoExpand){a.$autoSizeElement.html(g.escapeHTML(g.sanitizeBreakLines(a.$element.val()))+" ");var b=a.$autoSize.height();a.$element.height()!==b&&(a.$element.height(b),a.$backgroundDiv.height(b))}},h.prototype.cloneCSSToTarget=function(b){var c=this.$element,d=["lineHeight","textDecoration","letterSpacing","fontSize","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","wordWrap","word-break","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","boxSizing","webkitBoxSizing","mozBoxSizing","msBoxSizing"],e=null;a.each(d,function(a,d){e=c.css(d),b.css(d)!==e&&b.css(d,e)})},h.prototype.destroy=function(){a.data(this.element,"plugin_"+f,!1),this.$backgroundDiv.remove(),this.$autoSize.remove(),this.$element.data("highlighterTimerId",-1).off("scroll.textarea.highlighter").off("input.textarea.highlighter").off("keyup.textarea.highlighter").off("propertychange.textarea.highlighter").attr("style","").unwrap()},h.prototype.debugModeOn=function(){this.settings.debug=!0,this.$backgroundDiv.css({color:"#f00"}),this.$element.css({color:"rgba(0,0,0,0.5)"})},h.prototype.debugModeOff=function(){this.settings.debug=!1,this.$backgroundDiv.css({color:"transparent"}),this.$element.css({color:"inherit"})},a.fn.textareaHighlighter=function(b){var c=arguments;return this.each(function(){var d=a(this),e=d.data(f),g="object"==typeof b&&b;if(b&&(e||"string"!=typeof b)&&(e||(e=new h(d,g),d.data(f,e)),"string"==typeof b)){if(!e[b])throw"Unknown method: "+b;e[b].apply(e,Array.prototype.slice.call(c,1))}})}}(a,window,document)});