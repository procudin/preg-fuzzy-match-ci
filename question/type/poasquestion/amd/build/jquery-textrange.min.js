!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b,c={get:function(a){return d[b].get.apply(this,[a])},set:function(a,c){var e,f=parseInt(a),g=parseInt(c);return"undefined"==typeof a?f=0:a<0&&(f=this[0].value.length+f),"undefined"!=typeof c&&(e=c>=0?f+g:this[0].value.length+g),d[b].set.apply(this,[f,e]),this},setcursor:function(a){return this.textrange("set",a,0)},replace:function(a){return d[b].replace.apply(this,[String(a)]),this},insert:function(a){return this.textrange("replace",a)}},d={xul:{get:function(a){var b={position:this[0].selectionStart,start:this[0].selectionStart,end:this[0].selectionEnd,length:this[0].selectionEnd-this[0].selectionStart,text:this.val().substring(this[0].selectionStart,this[0].selectionEnd)};return"undefined"==typeof a?b:b[a]},set:function(a,b){"undefined"==typeof b&&(b=this[0].value.length),this[0].selectionStart=a,this[0].selectionEnd=b},replace:function(a){var b=this[0].selectionStart,c=this[0].selectionEnd,d=this.val();this.val(d.substring(0,b)+a+d.substring(c,d.length)),this[0].selectionStart=b,this[0].selectionEnd=b+a.length}},msie:{get:function(a){var b=document.selection.createRange();if("undefined"==typeof b){var c={position:0,start:0,end:this.val().length,length:this.val().length,text:this.val()};return"undefined"==typeof a?c:c[a]}var d=0,e=0,f=this[0].value.length,g=this[0].value.replace(/\r\n/g,"\n"),h=this[0].createTextRange(),i=this[0].createTextRange();h.moveToBookmark(b.getBookmark()),i.collapse(!1),h.compareEndPoints("StartToEnd",i)===-1?(d=-h.moveStart("character",-f),d+=g.slice(0,d).split("\n").length-1,h.compareEndPoints("EndToEnd",i)===-1?(e=-h.moveEnd("character",-f),e+=g.slice(0,e).split("\n").length-1):e=f):(d=f,e=f);var c={position:d,start:d,end:e,length:f,text:b.text};return"undefined"==typeof a?c:c[a]},set:function(a,b){var c=this[0].createTextRange();if("undefined"!=typeof c){"undefined"==typeof b&&(b=this[0].value.length);var d=a-(this[0].value.slice(0,a).split("\r\n").length-1),e=b-(this[0].value.slice(0,b).split("\r\n").length-1);c.collapse(!0),c.moveEnd("character",e),c.moveStart("character",d),c.select()}},replace:function(a){document.selection.createRange().text=a}}};a.fn.textrange=function(d){return"undefined"==typeof this[0]?this:("undefined"==typeof b&&(b="selectionStart"in this[0]?"xul":document.selection?"msie":"unknown"),"unknown"===b?this:(document.activeElement!==this[0]&&this[0].focus(),"undefined"==typeof d||"string"!=typeof d?c.get.apply(this):"function"==typeof c[d]?c[d].apply(this,Array.prototype.slice.call(arguments,1)):void a.error("Method "+d+" does not exist in jQuery.textrange")))}});